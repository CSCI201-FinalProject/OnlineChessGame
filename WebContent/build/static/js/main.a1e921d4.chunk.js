(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{140:function(e,t,n){},141:function(e,t,n){},439:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(130),o=n.n(r),s=(n(140),n(8)),i=(n(141),n(142),n(132)),u=n(444),l=n(3);function b(e){var t=e.children,n=e.black?"square-black":"square-white";return Object(l.jsx)("div",{className:"".concat(n," board-square"),children:t})}var d=["r","n","b","q"];function j(e){var t=e.promotion,n=t.from,c=t.to,a=t.color;return Object(l.jsx)("div",{className:"board",children:d.map((function(e,t){return Object(l.jsx)("div",{className:"promote-square",children:Object(l.jsx)("div",{className:"piece-container",onClick:function(){return C(n,c,e)},children:Object(l.jsx)("img",{src:"assets/images/".concat(e,"_").concat(a,".png"),className:"piece cursor-pointer"})})},t)}))})}var m=new i,f=new u.a({board:m.board});var O,v=new WebSocket("ws://ec2-3-128-29-8.us-east-2.compute.amazonaws.com:8080/OnlineChessGame/GameEndpoint"),p="b",h=!1,x=!1,g=null,N=[];window.location.search.substr(1).split("&").forEach((function(e){"name"===(N=e.split("="))[0]&&(g=decodeURIComponent(N[1]))})),O=g;var w="Waiting For Player To Connect";v.onopen=function(e){v.send("username="+O)};var E=!0,S=0;function I(){S+=1}function C(e,t,n){if(h){var c={from:e,to:t};n&&(c.promotion=n),m.move(c)&&(k(),v.send('{"from":"'.concat(e,'","to":"').concat(t,'","promotion":"').concat(n,'"}'),(function(){})),h=!1)}}function k(e){var t=m.game_over(),n={board:m.board(),pendingPromotion:e,isGameOver:t,turn:m.turn(),result:t?y():null,myUsername:O,opponentUsername:w,started:x};f.next(n)}function y(){var e="",t="";if(e=O,t=w,m.in_checkmate()){var n="w"===m.turn()?"BLACK":"WHITE";return"w"==p&&"WHITE"==n?v.send("GameOver,"+e+","+t+",win,"+S):"b"==p&&"BLACK"==n&&v.send("GameOver,"+e+","+t+",lose,"+S),"CHECKMATE - WINNER - ".concat(n)}if(m.in_draw()){var c="50 - MOVES - RULE";return m.in_stalemate()?c="STALEMATE":m.in_threefold_repetition()?c="REPITITION":m.insufficient_material()&&(c="INSUFFICIENT MATERIAL"),"w"==p&&v.send("GameOver,"+e+","+t+",tie,"+S),"DRAW - ".concat(c)}return"UNKNOWN REASON"}v.onmessage=function(e){if(console.log("Recieved data from server "+e.data),"username="==e.data.substring(0,9))w=e.data.substring(9),window.setInterval(I,1e3),k();else if(E)x=!0,E=!1,"w"===(p=e.data)&&(h=!0),k();else{var t=JSON.parse(e.data),n=t.from,c=t.to,a=t.promotion,r={from:n,to:c};a&&(r.promotion=a),m.move(r)&&(k(),h=!0)}},v.onclose=function(e){},v.onerror=function(e){};var M=n(445),T=n(442);function _(e){var t=e.piece,n=t.type,c=t.color,a=e.position,r=Object(M.a)({item:{type:"piece",id:"".concat(a,"_").concat(n,"_").concat(c)},collect:function(e){return{isDragging:!!e.isDragging()}}}),o=Object(s.a)(r,3),i=o[0].isDragging,u=o[1],b=o[2],d="assets/images/".concat(n,"_").concat(c,".png");return Object(l.jsxs)("div",{className:"test",children:[Object(l.jsx)(T.a,{connect:b,src:d}),Object(l.jsx)("div",{className:"piece-container",ref:u,style:{opacity:i?0:1},children:Object(l.jsx)("img",{src:d,className:"piece"})})]})}var A=n(446);function G(e){var t=e.piece,n=e.black,a=e.position,r=Object(c.useState)(null),o=Object(s.a)(r,2),i=o[0],u=o[1],d=Object(A.a)({accept:"piece",drop:function(e){!function(e,t){var n=m.moves({verbose:!0}).filter((function(e){return e.promotion}));console.table(n),n.some((function(n){return"".concat(n.from,":").concat(n.to)==="".concat(e,":").concat(t)}))&&k({from:e,to:t,color:n[0].color}),f.getValue().pendingPromotion||C(e,t)}(e.id.split("_")[0],a)}}),O=Object(s.a)(d,2)[1];return Object(c.useEffect)((function(){var e=f.subscribe((function(e){var t=e.pendingPromotion;return t&&t.to===a?u(t):u(null)}));return function(){return e.unsibscribe()}}),[]),Object(l.jsx)("div",{className:"board-square",ref:O,children:Object(l.jsx)(b,{black:n,children:i?Object(l.jsx)(j,{promotion:i}):t?Object(l.jsx)(_,{piece:t,position:a}):null})})}function U(e){var t=e.board,n=e.turn,a=Object(c.useState)([]),r=Object(s.a)(a,2),o=r[0],i=r[1];function u(e){return{x:"w"===p?e%8:Math.abs(e%8-7),y:"w"===p?Math.abs(Math.floor(e/8)-7):Math.floor(e/8)}}function b(e){var t=u(e);return(t.x+t.y)%2==0}function d(e){var t=u(e),n=t.x,c=t.y;return"".concat(["a","b","c","d","e","f","g","h"][n]).concat(c+1)}return Object(c.useEffect)((function(){i("w"===p?t.flat():t.flat().reverse())}),[t,n]),Object(l.jsx)("div",{className:"board",children:o.map((function(e,t){return Object(l.jsx)("div",{className:"square",children:Object(l.jsx)(G,{piece:e,black:b(t),position:d(t)})},t)}))})}function R(){window.location.href="http://ec2-3-128-29-8.us-east-2.compute.amazonaws.com:8080/OnlineChessGame/GameEndpoint"}var F=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),o=Object(s.a)(r,2),i=o[0],u=o[1],b=Object(c.useState)(),d=Object(s.a)(b,2),j=d[0],m=d[1],O=Object(c.useState)(),v=Object(s.a)(O,2),p=v[0],h=v[1],x=Object(c.useState)(),g=Object(s.a)(x,2),N=g[0],w=g[1],E=Object(c.useState)(),S=Object(s.a)(E,2),I=S[0],C=S[1];return Object(c.useEffect)((function(){k();var e=f.subscribe((function(e){a(e.board),u(e.isGameOver),m(e.result),h(e.started),w(e.myUsername),C(e.opponentUsername)}));return function(){return e.unsibscribe()}}),[]),Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{children:j&&Object(l.jsx)("button",{className:"returnButton",onClick:R,children:Object(l.jsx)("h1",{children:" MAIN MENU "})})}),Object(l.jsx)("div",{className:"searching",children:p?"":"Searching For Game..."}),Object(l.jsxs)("div",{className:"container",children:[i&&Object(l.jsx)("h2",{className:"vertical-text",children:" GAME OVER"}),Object(l.jsxs)("div",{className:"board-container",children:[Object(l.jsx)("div",{className:"opponentUsernameBox",children:I}),Object(l.jsx)(U,{board:n}),Object(l.jsx)("div",{className:"myUsernameBox",children:N})]}),j&&Object(l.jsx)("p",{className:"vertical-text",children:j})]})]})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,447)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))},B=n(443),L=n(134);o.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(B.a,{backend:L.a,children:Object(l.jsx)(F,{})})}),document.getElementById("root")),q()}},[[439,1,2]]]);
//# sourceMappingURL=main.a1e921d4.chunk.js.map